<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VES Library</title>
  <style>
    :root { color-scheme: dark; }
    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at 15% 20%, #f9731622, transparent 30%), radial-gradient(circle at 80% 20%, #22d3ee22, transparent 30%), #0b1220;
      color: #e5e7eb;
    }
    header { padding: 28px 24px 12px; }
    h1 { margin: 0; font-size: 24px; letter-spacing: 0.02em; }
    p { margin: 6px 0 0; color: #9ca3af; }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
      padding: 0 24px 32px;
    }
    .card {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 18px 50px rgba(0,0,0,0.35);
      transition: transform 120ms ease, border-color 120ms ease;
    }
    .card:hover { transform: translateY(-2px); border-color: rgba(255,255,255,0.16); }
    .card h3 { margin: 0 0 6px; font-size: 16px; }
    .meta { font-size: 13px; color: #a5b4fc; margin-bottom: 8px; }
    .desc { font-size: 13px; color: #cbd5e1; margin: 0 0 10px; }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.12);
      font-size: 13px;
      color: #e5e7eb;
      text-decoration: none;
    }
    .status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: #9ca3af;
      margin-bottom: 6px;
    }
    .dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: #6b7280;
      box-shadow: 0 0 0 1px rgba(255,255,255,0.08);
    }
    .dot.up { background: #22c55e; }
    .dot.down { background: #ef4444; }
    a { color: inherit; text-decoration: none; }
  </style>
</head>
<body>
  <header>
    <h1>VES Library</h1>
    <p>Hitri vstopi do glavnih portalov in API-jev.</p>
    <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
      <button id="btn-refresh" style="padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.06);color:#e5e7eb;cursor:pointer;">Refresh now</button>
      <div style="display:flex; gap:6px; align-items:center; flex-wrap:wrap;">
        <input id="custom-url" type="text" placeholder="https://â€¦" style="padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.15);background:rgba(0,0,0,0.25);color:#e5e7eb;min-width:240px;">
        <button id="btn-open" style="padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.12);background:rgba(34,197,94,0.15);color:#bbf7d0;cursor:pointer;">Open</button>
      </div>
    </div>
  </header>
  <div class="grid">
    <div class="card">
      <h3>n8n Automation</h3>
      <div class="meta">http://localhost:5678</div>
      <p class="desc">Workflow editor in runtime.</p>
      <div class="status"><span class="dot" id="status-n8n"></span><span id="text-n8n">Pinging...</span></div>
      <a class="pill" href="http://localhost:5678" target="_blank" rel="noopener">Odpri</a>
    </div>
    <div class="card">
      <h3>VES Frontend</h3>
      <div class="meta">http://localhost:8081</div>
      <p class="desc">Static VES web UI (nginx).</p>
      <div class="status"><span class="dot" id="status-frontend"></span><span id="text-frontend">Pinging...</span></div>
      <a class="pill" href="http://localhost:8081" target="_blank" rel="noopener">Odpri</a>
    </div>
    <div class="card">
      <h3>VES Desktop (VNC)</h3>
      <div class="meta">http://localhost:8082</div>
      <p class="desc">Browser VNC za LXDE desktop.</p>
      <div class="status"><span class="dot" id="status-vnc"></span><span id="text-vnc">Pinging...</span></div>
      <a class="pill" href="http://localhost:8082" target="_blank" rel="noopener">Odpri</a>
    </div>
    <div class="card">
      <h3>Cosmic Oracle</h3>
      <div class="meta">http://localhost:8888</div>
      <p class="desc">Pattern connector API/UI.</p>
      <div class="status"><span class="dot" id="status-oracle"></span><span id="text-oracle">Pinging...</span></div>
      <a class="pill" href="http://localhost:8888" target="_blank" rel="noopener">Odpri</a>
    </div>
    <div class="card">
      <h3>File Server</h3>
      <div class="meta">http://localhost:8080</div>
      <p class="desc">Static files (read-only).</p>
      <div class="status"><span class="dot" id="status-files"></span><span id="text-files">Pinging...</span></div>
      <a class="pill" href="http://localhost:8080" target="_blank" rel="noopener">Odpri</a>
    </div>
    <div class="card">
      <h3>Orchestrator</h3>
      <div class="meta">http://localhost:8092</div>
      <p class="desc">Node orchestrator module.</p>
      <div class="status"><span class="dot" id="status-orch"></span><span id="text-orch">Pinging...</span></div>
      <a class="pill" href="http://localhost:8092" target="_blank" rel="noopener">Odpri</a>
    </div>
    <div class="card">
      <h3>Sovereignty API</h3>
      <div class="meta">http://localhost:8421/sovereignty/status</div>
      <p class="desc">Influence & tier metrics (8421, fallback 8420).</p>
      <div class="status"><span class="dot" id="status-sov"></span><span id="text-sov">Pinging...</span></div>
      <a class="pill" href="http://localhost:8421/sovereignty/status" target="_blank" rel="noopener">Odpri</a>
    </div>
    <div class="card">
      <h3>Ghostline Command Deck</h3>
      <div class="meta">http://localhost:8085</div>
      <p class="desc">Fleet dashboard (if running).</p>
      <div class="status"><span class="dot" id="status-deck"></span><span id="text-deck">Pinging...</span></div>
      <a class="pill" href="http://localhost:8085" target="_blank" rel="noopener">Odpri</a>
    </div>
    <div class="card">
      <h3>Sovereignty HUD</h3>
      <div class="meta">http://localhost:8081/ves-hud.html</div>
      <p class="desc">Cyber HUD: tier, connectivity, event log.</p>
      <a class="pill" href="http://localhost:8081/ves-hud.html" target="_blank" rel="noopener">Odpri</a>
    </div>
  </div>
  <script>
    const targets = [
      { id: 'n8n', urls: ['http://localhost:5678'] },
      { id: 'frontend', urls: ['http://localhost:8081'] },
      { id: 'vnc', urls: ['http://localhost:8082'] },
      { id: 'oracle', urls: ['http://localhost:8888'] },
      { id: 'files', urls: ['http://localhost:8080'] },
      { id: 'orch', urls: ['http://localhost:8092'] },
      { id: 'sov', urls: ['http://localhost:8421/sovereignty/status', 'http://localhost:8420/sovereignty/status'] },
      { id: 'deck', urls: ['http://localhost:8085'] },
    ];

    function setStatus(id, ok) {
      const dot = document.getElementById(`status-${id}`);
      const txt = document.getElementById(`text-${id}`);
      if (!dot || !txt) return;
      dot.classList.remove('up', 'down');
      dot.classList.add(ok ? 'up' : 'down');
      txt.textContent = ok ? 'Online' : 'No signal';
    }

    async function ping(url) {
      try {
        const ctrl = new AbortController();
        setTimeout(() => ctrl.abort(), 2500);
        await fetch(url, { mode: 'no-cors', signal: ctrl.signal });
        return true;
      } catch (e) {
        return false;
      }
    }

    async function refresh() {
      for (const t of targets) {
        let ok = false;
        for (const url of t.urls) {
          ok = await ping(url);
          if (ok) break;
        }
        setStatus(t.id, ok);
      }
    }

    refresh();
    setInterval(refresh, 30000);
    document.getElementById('btn-refresh').addEventListener('click', refresh);
    document.getElementById('btn-open').addEventListener('click', () => {
      const url = document.getElementById('custom-url').value.trim();
      if (url) window.open(url, '_blank', 'noopener');
    });
  </script>
</body>
</html>
